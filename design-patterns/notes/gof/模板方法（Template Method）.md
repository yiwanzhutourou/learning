# 模板方法（Template Method）

## 意图

> Defining the skeleton of an algorithm in an operation, deferring some steps to subclasses. Template Method lets subclasses redefine certain steps of an algorithm without changing the algorithm's structire.
>
> 在一个方法中定义一个算法的框架，将某些步骤延迟到子类中实现。模板方法使得子类可以重新实现算法的某些步骤而不改变算法的结构。

模板方法是一种继承结构下的代码重用技巧，将通用逻辑提取到父类中，而将一些特殊逻辑交由子类实现，而算法的整个流程由父类统一管控。模板方法由父类实现统一逻辑，再将部分实现延迟到子类的做法对应了一个设计的原则——好莱坞原则（the Hollywood principle），英文原文是“Don't call us, we'll call you”，转换为设计模式的语言就是，子类不要直接调用父类的方法，而应该由父类来调用子类的方法。父类依赖的是定义在父类中的抽象方法，或者默认为空实现的钩子（hook）方法，而子类不直接调用父类的方法，这样就将子类和父类之间的依赖降低了。后续不管是修改父类中的模板方法，还是修改子类中的具体实现，只要定义在父类中的接口不变，就不会互相影响。当然，如果父类中的算法逻辑有改变，所有的子类都会受到影响，有的时候子类并不一定想要这样的改变，这也是继承结构的问题之一。

## 适用场景

- 在父类中实现算法的通用部分，而由子类实现算法中某些特定的部分。
- 通过抽取模板方法来实现代码复用。
- 父类提供钩子（hook）方法由子类实现，使得子类可以在算法的特定阶段做出反应，定义在父类中的钩子方法通常是空实现，子类可以选择重写，但并不强求。

## 结构图

![模板方法结构图](https://youdu-markdown.oss-cn-shanghai.aliyuncs.com/20191204134511.png)

## 参与角色

- AbstractClass
  - 将算法中的特定步骤定义为抽象方法供子类实现
  - 定义模板方法实现算法的框架，模板方法会调用上面提到的抽象方法
- ConcreteClass
  - 实现定义在父类中的抽象方法

## 与其他模式的比较

- 工厂方法（Factory Method）可以理解为是模板方法的一种特殊情况，工厂方法特指创建对象的方法。
- 策略模式（Strategy）和模板方法的意图都是提供算法的不同实现，策略模式用组合的方式改变整个算法的实现，而模板方法用继承的方式改变一个通用算法中某些步骤的实现。